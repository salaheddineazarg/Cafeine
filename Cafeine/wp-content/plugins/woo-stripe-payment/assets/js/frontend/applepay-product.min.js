!function(i,a){function t(){a.BaseGateway.call(this,wc_stripe_applepay_product_params),this.old_qty=this.get_quantity()}(t.prototype=i.extend({},a.BaseGateway.prototype,a.ProductGateway.prototype,a.ApplePay.prototype)).initialize=function(){i(".wc_stripe_product_payment_methods "+this.container).length?(this.container=".wc_stripe_product_payment_methods "+this.container,a.ProductGateway.call(this),a.ApplePay.prototype.initialize.call(this)):setTimeout(this.initialize.bind(this),1e3)},t.prototype.canMakePayment=function(){a.ApplePay.prototype.canMakePayment.call(this).then(function(){i(document.body).on("change",'[name="quantity"]',this.add_to_cart.bind(this)),i(this.container).parent().parent().addClass("active"),this.is_variable_product()?this.variable_product_selected()?this.cart_calculation(this.get_product_data().variation.variation_id):this.disable_payment_button():this.cart_calculation()}.bind(this))},t.prototype.start=function(t){0===this.get_quantity()?(t.preventDefault(),this.submit_error(this.params.messages.invalid_amount)):a.ApplePay.prototype.start.apply(this,arguments)},t.prototype.append_button=function(){var t=document.querySelectorAll(".wc-stripe-applepay-container");t&&1<t.length?(i.each(t,function(t,a){i(a).empty(),i(a).append(this.$button.clone(!0))}.bind(this)),this.$button=i(".wc-stripe-applepay-container").find("button")):i("#wc-stripe-applepay-container").append(this.$button)},t.prototype.add_to_cart=function(){this.disable_payment_button(),this.old_qty=this.get_quantity();var t=this.get_product_data().variation;this.processing_calculation||this.is_variable_product()&&!this.variable_product_selected()||this.cart_calculation(t.variation_id).then(function(){this.is_variable_product()?(this.createPaymentRequest(),a.ApplePay.prototype.canMakePayment.apply(this,arguments).then(function(){this.enable_payment_button()}.bind(this))):this.enable_payment_button()}.bind(this))},t.prototype.found_variation=function(t){a.ProductGateway.prototype.found_variation.apply(this,arguments),this.can_pay&&this.add_to_cart()},new t}(jQuery,wc_stripe);